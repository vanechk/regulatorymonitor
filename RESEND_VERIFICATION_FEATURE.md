# Функциональность повторной отправки письма с подтверждением

## Описание

Добавлена возможность повторной отправки письма с подтверждением email адреса со страницы регистрации. Это решает проблему, когда пользователь не получил первое письмо или ссылка в нем истекла.

## Как это работает

### 1. После успешной регистрации
- Пользователь видит сообщение об успешной регистрации
- Под сообщением появляется кнопка **"Отправить письмо повторно"**
- Сохраняется email адрес для повторной отправки

### 2. При нажатии на кнопку повторной отправки
- **Если старый токен еще действителен** (не истек):
  - Отправляется письмо с тем же токеном
  - Пользователь получает то же письмо
  
- **Если старый токен истек**:
  - Удаляется старый временный пользователь
  - Создается новый с новым токеном
  - Отправляется новое письмо с новым токеном
  - **Старая ссылка перестает работать**

### 3. Безопасность
- Старые токены автоматически инвалидируются при создании новых
- Каждый новый токен имеет срок действия 24 часа
- Предотвращается повторное использование истекших токенов

## Техническая реализация

### Backend API
- **Endpoint**: `POST /api/auth/resend-verification`
- **Параметры**: `{ email: string }`
- **Логика**:
  1. Поиск временного пользователя по email
  2. Проверка срока действия токена
  3. Создание нового токена при необходимости
  4. Отправка email с подтверждением

### Frontend
- **Компонент**: `Auth.tsx`
- **Состояние**: `registeredEmail` для хранения email после регистрации
- **Функция**: `handleResendVerification()` для обработки повторной отправки

### Обновления UI
- Кнопка повторной отправки на странице регистрации
- Информационное сообщение на странице верификации о том, что старые ссылки не работают

## Пример использования

1. **Пользователь регистрируется** → получает письмо с подтверждением
2. **Письмо не пришло или ссылка не работает** → нажимает "Отправить письмо повторно"
3. **Получает новое письмо** → использует новую ссылку для подтверждения
4. **Старая ссылка больше не работает** → обеспечивается безопасность

## Преимущества

✅ **Удобство пользователя** - не нужно регистрироваться заново
✅ **Безопасность** - старые токены автоматически инвалидируются  
✅ **Автоматизация** - система сама определяет, нужен ли новый токен
✅ **Информативность** - пользователь понимает, что происходит

## Требования

- Запущенный сервер API (порт 3000)
- Настроенный email сервис
- База данных с таблицей `pendingUser`

## Тестирование

Для тестирования используйте файл `test-resend-verification.js`:

```bash
node test-resend-verification.js
```

Не забудьте заменить email на реальный для тестирования.
