# Экспорт в Excel с фильтрацией по типу источника

## Описание функциональности

Реализована возможность экспорта новостей в Excel файл с поддержкой фильтрации по:
- **Временному диапазону** (дата начала и окончания)
- **Типу источника** (веб-сайты, Telegram-каналы, все источники)
- **Ключевым словам** (опционально)

## Изменения в коде

### 1. Обновлена функция `exportToExcel` в `api.ts`
- Добавлен параметр `sourceType` для фильтрации по типу источника
- Улучшена структура Excel файла с дополнительными колонками:
  - Дата публикации
  - Название источника
  - Тип источника (Веб-сайт/Telegram)
  - Ссылка на источник
- Улучшено именование файлов с учетом фильтров

### 2. Обновлен клиентский API (`src/client/api.ts`)
- Добавлен параметр `sourceType` в функцию `exportToExcel`
- Передача параметра через URL query string

### 3. Добавлен endpoint в серверный API (`src/server/api.ts`)
- Новый endpoint `/api/reports/export` для обработки запросов экспорта
- Поддержка всех параметров фильтрации

### 4. Обновлены компоненты интерфейса
- `src/client/pages/Dashboard.tsx`: передача `sourceType` в функцию экспорта
- `app.tsx`: аналогичные изменения
- Обновлены типы для поддержки нового параметра

### 5. Обновлены типы данных (`src/types/api.ts`)
- Добавлено поле `source` в интерфейс `NewsItem`

## Использование

### На фронтенде
Пользователь может:
1. Выбрать тип источника: "Все источники", "Веб-сайты", "Telegram-каналы"
2. Установить временной диапазон
3. Добавить ключевые слова для фильтрации (опционально)
4. Нажать кнопку "Экспорт в Excel"

### Результат
- Создается Excel файл с отфильтрованными новостями
- Файл содержит расширенную информацию о каждой новости
- Имя файла отражает примененные фильтры
- Отчет сохраняется в базе данных для последующего доступа

## Структура Excel файла

| Колонка | Описание |
|---------|----------|
| № | Порядковый номер |
| Дата публикации | Дата публикации новости |
| Источник | Название источника |
| Тип источника | Веб-сайт/Telegram |
| № и дата Письма | Ссылка на документ |
| Налог | Тип налога |
| Предмет рассмотрения | Тема новости |
| Позиция МФ, ФНС | Основное содержание |
| Ссылка | URL источника |

## Тестирование

Создан тестовый файл `test-export-excel.js` для проверки различных сценариев экспорта:
- Экспорт всех новостей
- Экспорт только веб-сайтов
- Экспорт только Telegram-каналов
- Экспорт с комбинированными фильтрами 